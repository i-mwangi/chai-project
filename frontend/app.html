<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chai Platform</title>
    <link rel="icon" href="public/chai.png">
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/marketplace.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Comic+Neue:ital,wght@0,400;0,700;1,400;1,700&display=swap');
        
        body {
            font-family: 'Comic Neue', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- Navigation -->
        <nav class="navbar">
            <div class="nav-container">
                <div class="nav-brand">
                    <h1><img src="public/chai.png" alt="Chai Platform Logo" width="30" height="30" style="vertical-align: middle; margin-right: 10px;"> Chai Platform</h1>
                </div>
                <div class="nav-menu">
                    <button class="nav-btn active" data-view="dashboard">Dashboard</button>
                    <button class="nav-btn" data-view="farmer">Farmer Portal</button>
                    <button class="nav-btn" data-view="investor">Investor Portal</button>
                    <button class="nav-btn hidden" id="adminNavBtn" data-view="admin">Admin</button>
                </div>
                <div class="nav-user">
                    <div class="wallet-connection">
                        <button id="connectWallet" class="btn btn-primary">Connect Wallet</button>
                        <div id="walletInfo" class="wallet-info hidden">
                            <span id="walletAddress"></span>
                            <button id="disconnectWallet" class="btn btn-secondary">Disconnect</button>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard View -->
            <div id="dashboardView" class="view active">
                <div class="dashboard-header">
                    <h2>Platform Overview</h2>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3>Total Groves</h3>
                            <div class="stat-value" id="totalGroves">-</div>
                        </div>
                        <div class="stat-card">
                            <h3>Active Farmers</h3>
                            <div class="stat-value" id="activeFarmers">-</div>
                        </div>
                        <div class="stat-card">
                            <h3>Total Revenue</h3>
                            <div class="stat-value" id="totalRevenue">-</div>
                        </div>
                        <div class="stat-card">
                            <h3>Coffee Price</h3>
                            <div class="stat-value" id="coffeePrice">-</div>
                        </div>
                    </div>
                    
                    <!-- Wallet Connection Prompt -->
                    <div id="walletPrompt" class="wallet-prompt">
                        <div class="prompt-card">
                            <h3>🔗 Connect Your Wallet to Get Started</h3>
                            <p>Connect your Hedera wallet to access farmer and investor features:</p>
                            <ul>
                                <li><strong>Farmers:</strong> Register groves, report harvests, track revenue</li>
                                <li><strong>Investors:</strong> Browse groves, purchase tokens, manage portfolio</li>
                            </ul>
                            <button class="btn btn-primary btn-large" onclick="window.walletManager.connectWallet()">
                                Connect Wallet Now
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Farmer Portal View -->
            <div id="farmerView" class="view">
                <div class="farmer-dashboard">
                    <div class="dashboard-sidebar">
                        <div class="sidebar-menu">
                            <button class="menu-item active" data-section="groves">My Groves</button>
                            <button class="menu-item" data-section="harvest">Harvest Reports</button>
                            <button class="menu-item" data-section="revenue">Revenue Tracking</button>
                            <button class="menu-item" data-section="health">Tree Health</button>
                            <button class="menu-item" data-section="pricing">Market Prices</button>
                            <button class="menu-item" data-section="transactions">Transaction History</button>
                            <button class="menu-item" data-section="verification">Verification</button>
                        </div>
                    </div>
                    
                    <div class="dashboard-content">
                        <!-- Grove Management Section -->
                        <div id="grovesSection" class="section active">
                            <div class="section-header">
                                <h3>Grove Management</h3>
                                <button id="addGroveBtn" class="btn btn-primary">Register New Grove</button>
                            </div>
                            
                            <div class="groves-grid" id="grovesGrid">
                                <!-- Grove cards will be populated here -->
                            </div>
                            
                            <!-- Grove Registration Modal -->
                            <div id="groveModal" class="modal">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h4>Register Coffee Grove</h4>
                                        <button class="modal-close">&times;</button>
                                    </div>
                                    <form id="groveForm" class="modal-body">
                                        <div class="form-group">
                                            <label for="groveName">Grove Name</label>
                                            <input type="text" id="groveName" name="groveName" required>
                                        </div>
                                        
                                        <div class="form-group">
                                            <label for="location">Location</label>
                                            <input type="text" id="location" name="location" placeholder="e.g., Costa Rica, Central Valley" required>
                                        </div>
                                        
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label for="latitude">Latitude</label>
                                                <input type="number" id="latitude" name="latitude" step="any" required>
                                            </div>
                                            <div class="form-group">
                                                <label for="longitude">Longitude</label>
                                                <input type="number" id="longitude" name="longitude" step="any" required>
                                            </div>
                                        </div>
                                        
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label for="treeCount">Number of Trees</label>
                                                <input type="number" id="treeCount" name="treeCount" min="1" required>
                                            </div>
                                            <div class="form-group">
                                                <label for="coffeeVariety">Coffee Variety</label>
                                                <select id="coffeeVariety" name="coffeeVariety" required>
                                                    <option value="">Select variety</option>
                                                    <option value="Arabica">Arabica</option>
                                                    <option value="Robusta">Robusta</option>
                                                    <option value="Bourbon">Bourbon</option>
                                                    <option value="Typica">Typica</option>
                                                    <option value="Caturra">Caturra</option>
                                                    <option value="Geisha">Geisha</option>
                                                </select>
                                            </div>
                                        </div>
                                        
                                        <div class="form-group">
                                            <label for="expectedYield">Expected Yield per Tree (kg/year)</label>
                                            <input type="number" id="expectedYield" name="expectedYield" step="0.1" min="0" required>
                                        </div>
                                        
                                        <div class="form-group">
                                            <label>Location on Map</label>
                                            <div id="groveMap" class="map-container"></div>
                                            <small>Click on the map to set grove location</small>
                                        </div>
                                        
                                        <div class="modal-actions">
                                            <button type="button" class="btn btn-secondary" id="cancelGrove">Cancel</button>
                                            <button type="submit" class="btn btn-primary">Register Grove</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>

                        <!-- Harvest Reports Section -->
                        <div id="harvestSection" class="section">
                            <div class="section-header">
                                <h3>Harvest Reports</h3>
                                <button id="addHarvestBtn" class="btn btn-primary">Report New Harvest</button>
                            </div>
                            
                            <div class="harvest-list" id="harvestList">
                                <!-- Harvest reports will be populated here -->
                            </div>
                            
                            <!-- Harvest Report Modal -->
                            <div id="harvestModal" class="modal">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h4>Report Harvest</h4>
                                        <button class="modal-close">&times;</button>
                                    </div>
                                    <form id="harvestForm" class="modal-body">
                                        <div class="form-group">
                                            <label for="harvestGrove">Select Grove</label>
                                            <select id="harvestGrove" name="groveId" required>
                                                <option value="">Select a grove</option>
                                            </select>
                                        </div>
                                        
                                        <div class="form-group">
                                            <label for="harvestDate">Harvest Date</label>
                                            <input type="date" id="harvestDate" name="harvestDate" required>
                                        </div>
                                        
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label for="coffeeVariety">Coffee Variety</label>
                                                <select id="coffeeVariety" name="coffeeVariety" required>
                                                    <option value="">Select variety</option>
                                                    <option value="ARABICA">Arabica</option>
                                                    <option value="ROBUSTA">Robusta</option>
                                                    <option value="SPECIALTY">Specialty</option>
                                                    <option value="ORGANIC">Organic</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label for="yieldKg">Total Yield (kg)</label>
                                                <input type="number" id="yieldKg" name="yieldKg" step="0.1" min="0" required>
                                            </div>
                                        </div>
                                        
                                        <div class="form-group">
                                            <label for="qualityGrade">Quality Grade: <span id="gradeValue">5</span> - <span id="gradeDescription">Medium Quality</span></label>
                                            <input type="range" id="qualityGrade" name="qualityGrade" min="1" max="10" value="5" required>
                                            <div class="grade-scale">
                                                <span>1 (Low)</span>
                                                <span>10 (Premium)</span>
                                            </div>
                                        </div>
                                        
                                        <div class="form-group">
                                            <label for="salePrice">Sale Price per kg (USDC)</label>
                                            <input type="number" id="salePrice" name="salePrice" step="0.01" min="0" required>
                                            <div id="suggestedPriceInfo" class="price-info" style="display: none;">
                                                <small>Suggested price: <strong id="suggestedPrice">-</strong> USDC/kg</small>
                                                <small id="priceValidation" class="validation-message"></small>
                                            </div>
                                        </div>
                                        
                                        <div id="projectedRevenueSection" class="projected-revenue" style="display: none;">
                                            <h5>Projected Revenue</h5>
                                            <div class="revenue-breakdown">
                                                <div class="revenue-item">
                                                    <span>Total Revenue:</span>
                                                    <strong id="projectedTotal">-</strong>
                                                </div>
                                                <div class="revenue-item">
                                                    <span>Your Share (30%):</span>
                                                    <strong id="projectedFarmerShare">-</strong>
                                                </div>
                                                <div class="revenue-item">
                                                    <span>Investor Share (70%):</span>
                                                    <strong id="projectedInvestorShare">-</strong>
                                                </div>
                                            </div>
                                            <div id="priceBreakdown" class="price-breakdown">
                                                <small>Base price: <span id="basePrice">-</span> USDC/kg</small>
                                                <small>Seasonal multiplier: <span id="seasonalMultiplier">-</span>x</small>
                                            </div>
                                        </div>
                                        
                                        <div class="form-group">
                                            <label for="notes">Additional Notes</label>
                                            <textarea id="notes" name="notes" rows="3" placeholder="Weather conditions, processing method, etc."></textarea>
                                        </div>
                                        
                                        <div class="modal-actions">
                                            <button type="button" class="btn btn-secondary" id="cancelHarvest">Cancel</button>
                                            <button type="submit" class="btn btn-primary">Submit Report</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                            
                            <!-- Withdrawal Confirmation Modal -->
                            <div id="withdrawalConfirmModal" class="modal">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h4>Confirm Withdrawal</h4>
                                        <button class="modal-close">&times;</button>
                                    </div>
                                    <div class="modal-body">
                                        <div class="confirmation-details">
                                            <p>Please confirm your withdrawal details:</p>
                                            <div class="detail-row">
                                                <label>Grove:</label>
                                                <span id="confirmGroveName">-</span>
                                            </div>
                                            <div class="detail-row">
                                                <label>Amount:</label>
                                                <span id="confirmAmount">$0.00</span>
                                            </div>
                                            <div class="detail-row">
                                                <label>Destination:</label>
                                                <span id="confirmDestination">-</span>
                                            </div>
                                        </div>
                                        <div class="modal-actions">
                                            <button type="button" class="btn btn-secondary" id="cancelWithdrawal">Cancel</button>
                                            <button type="button" class="btn btn-primary" id="confirmWithdrawal">Confirm Withdrawal</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Revenue Tracking Section -->
                        <div id="revenueSection" class="section">
                            <div class="section-header">
                                <h3>Revenue Tracking</h3>
                            </div>
                            
                            <div class="revenue-overview">
                                <div class="revenue-stats">
                                    <div class="stat-card">
                                        <h4>Total Earnings</h4>
                                        <div class="stat-value" id="totalEarnings">$0.00</div>
                                    </div>
                                    <div class="stat-card">
                                        <h4>This Month</h4>
                                        <div class="stat-value" id="monthlyEarnings">$0.00</div>
                                    </div>
                                    <div class="stat-card">
                                        <h4>Pending Distributions</h4>
                                        <div class="stat-value" id="pendingDistributions">$0.00</div>
                                    </div>
                                </div>
                                
                                <div class="revenue-chart">
                                    <canvas id="revenueChart"></canvas>
                                </div>
                            </div>
                            
                            <!-- Farmer Withdrawal Card -->
                            <div class="withdrawal-card">
                                <div class="section-header">
                                    <h4>Farmer Revenue Withdrawal</h4>
                                    <small>Withdraw your 30% share from harvest revenue</small>
                                </div>
                                
                                <div class="withdrawal-stats">
                                    <div class="stat-card">
                                        <h5>Available Balance</h5>
                                        <div class="stat-value" id="farmerAvailableBalance">$0.00</div>
                                        <small class="stat-label">Ready to withdraw</small>
                                    </div>
                                    <div class="stat-card">
                                        <h5>Pending</h5>
                                        <div class="stat-value" id="farmerPendingBalance">$0.00</div>
                                        <small class="stat-label">Processing</small>
                                    </div>
                                    <div class="stat-card">
                                        <h5>Total Withdrawn</h5>
                                        <div class="stat-value" id="farmerTotalWithdrawn">$0.00</div>
                                        <small class="stat-label">All-time</small>
                                    </div>
                                </div>
                                
                                <div class="withdrawal-form-container">
                                    <form id="farmerWithdrawalForm" class="withdrawal-form">
                                        <div class="form-group">
                                            <label for="withdrawalGrove">Select Grove</label>
                                            <select id="withdrawalGrove" name="groveId" required>
                                                <option value="">Select a grove</option>
                                            </select>
                                        </div>
                                        
                                        <div class="form-group">
                                            <label for="withdrawalAmount">Withdrawal Amount (USDC)</label>
                                            <div class="input-with-button">
                                                <input 
                                                    type="number" 
                                                    id="withdrawalAmount" 
                                                    name="amount" 
                                                    step="0.01" 
                                                    min="0.01" 
                                                    placeholder="Enter amount"
                                                    required
                                                >
                                                <button 
                                                    type="button" 
                                                    class="btn btn-secondary btn-small" 
                                                    id="withdrawMaxBtn"
                                                >
                                                    Max
                                                </button>
                                            </div>
                                            <small class="form-help" id="withdrawalHelp">Available: $0.00</small>
                                        </div>
                                        
                                        <button type="submit" class="btn btn-primary" id="withdrawBtn">
                                            Withdraw Funds
                                        </button>
                                    </form>
                                </div>
                            </div>
                            
                            <div class="distributions-list" id="distributionsList">
                                <!-- Distribution history will be populated here -->
                            </div>
                            
                            <!-- Withdrawal History Section -->
                            <div class="withdrawal-history-container">
                                <div class="section-header">
                                    <h4>Withdrawal History</h4>
                                    <small>Complete history of all withdrawals</small>
                                </div>
                                <div class="withdrawal-history-list" id="withdrawalHistoryList">
                                    <!-- Withdrawal history will be populated here -->
                                </div>
                            </div>
                        </div>

                        <!-- Tree Health Section -->
                        <div id="healthSection" class="section">
                            <div class="section-header">
                                <h3>Tree Health Monitoring</h3>
                            </div>
                            
                            <div class="health-overview" id="healthOverview">
                                <!-- Health monitoring cards will be populated here -->
                            </div>
                        </div>

                        <!-- Market Prices Section -->
                        <div id="pricingSection" class="section">
                            <div class="section-header">
                                <h3>Market Prices</h3>
                                <small>Current coffee prices by variety and quality grade</small>
                            </div>
                            
                            <!-- Variety Filter -->
                            <div class="pricing-filters">
                                <div class="form-group">
                                    <label for="priceVarietyFilter">Coffee Variety</label>
                                    <select id="priceVarietyFilter" class="variety-filter">
                                        <option value="">All Varieties</option>
                                        <option value="ARABICA">Arabica</option>
                                        <option value="ROBUSTA">Robusta</option>
                                        <option value="SPECIALTY">Specialty</option>
                                        <option value="ORGANIC">Organic</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- Current Prices Card -->
                            <div class="pricing-overview">
                                <div class="pricing-card">
                                    <h4>Current Market Prices</h4>
                                    <div id="currentPricesDisplay">
                                        <!-- Current prices will be populated here -->
                                    </div>
                                </div>
                                
                                <!-- Quality Grade Pricing Table -->
                                <div class="pricing-card">
                                    <h4>Quality Grade Pricing</h4>
                                    <small>Price per kilogram (USDC) by quality grade (1-10)</small>
                                    <div id="gradePricingTable">
                                        <!-- Grade pricing table will be populated here -->
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Seasonal Pricing Chart -->
                            <div class="pricing-card seasonal-pricing-card">
                                <h4>Seasonal Price Multipliers</h4>
                                <small>Monthly price adjustments throughout the year</small>
                                <div class="current-month-indicator" id="currentMonthIndicator">
                                    <!-- Current month multiplier will be displayed here -->
                                </div>
                                <div class="seasonal-chart-container">
                                    <canvas id="seasonalPricingChart"></canvas>
                                </div>
                                <div class="price-calculation-info" id="priceCalculationInfo">
                                    <!-- Price calculation breakdown tooltip will be shown here -->
                                </div>
                            </div>
                        </div>

                        <!-- Verification Section -->
                        <div id="verificationSection" class="section">
                            <div class="section-header">
                                <h3>Farmer Verification</h3>
                            </div>
                            
                            <div class="verification-status" id="verificationStatus">
                                <!-- Verification status will be populated here -->
                            </div>
                            
                            <div class="verification-form" id="verificationForm">
                                <h4>Submit Verification Documents</h4>
                                <div class="form-instructions">
                                    <p>Please upload clear, legible copies of the following documents. All documents must be current and valid.</p>
                                </div>
                                <form id="documentsForm">
                                    <div class="form-group">
                                        <label for="landOwnership">📄 Land Ownership Documents</label>
                                        <small class="form-help">Land title, deed, lease agreement, or property certificate proving your right to farm the land</small>
                                        <input type="file" id="landOwnership" name="landOwnership" accept=".pdf,.jpg,.png" required>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="farmingLicense">🌾 Farming License or Permit</label>
                                        <small class="form-help">Agricultural license, farming permit, cooperative membership, or coffee grower registration</small>
                                        <input type="file" id="farmingLicense" name="farmingLicense" accept=".pdf,.jpg,.png" required>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="identityDocument">🆔 Government-Issued Identity Document</label>
                                        <small class="form-help">National ID, passport, driver's license, or voter registration card</small>
                                        <input type="file" id="identityDocument" name="identityDocument" accept=".pdf,.jpg,.png" required>
                                    </div>
                                    
                                    <div class="form-requirements">
                                        <h6>Document Requirements:</h6>
                                        <ul>
                                            <li>✅ Accepted formats: PDF, JPG, PNG</li>
                                            <li>✅ Maximum file size: 10MB per document</li>
                                            <li>✅ Documents must be clear and legible</li>
                                            <li>✅ All text must be readable</li>
                                            <li>✅ Documents must be current and valid</li>
                                        </ul>
                                    </div>
                                    
                                    <button type="submit" class="btn btn-primary">Submit Documents for Review</button>
                                </form>
                            </div>
                        </div>

                        <!-- Farmer Transaction History Section -->
                        <div id="farmerTransactionsSection" class="section">
                            <div class="section-header">
                                <h3>Transaction History</h3>
                                <div class="section-actions">
                                    <select id="farmerTransactionTypeFilter" class="filter-select">
                                        <option value="all">All Transactions</option>
                                        <option value="distribution">Revenue Distributions</option>
                                        <option value="withdrawal">Withdrawals</option>
                                        <option value="sale">Token Sales</option>
                                    </select>
                                    <button id="exportFarmerTransactionsBtn" class="btn btn-secondary">
                                        📥 Export to CSV
                                    </button>
                                </div>
                            </div>

                            <div class="transaction-stats">
                                <div class="stat-card">
                                    <h4>Total Transactions</h4>
                                    <div class="stat-value" id="farmerTotalTransactions">0</div>
                                </div>
                                <div class="stat-card">
                                    <h4>Total Revenue</h4>
                                    <div class="stat-value" id="farmerTotalRevenue">$0.00</div>
                                </div>
                                <div class="stat-card">
                                    <h4>Completed</h4>
                                    <div class="stat-value" id="farmerCompletedTransactions">0</div>
                                </div>
                                <div class="stat-card">
                                    <h4>Pending</h4>
                                    <div class="stat-value" id="farmerPendingTransactions">0</div>
                                </div>
                            </div>

                            <div class="transactions-list" id="farmerTransactionsList">
                                <!-- Transactions will be populated here -->
                                <div class="empty-state">
                                    <p>No transactions found</p>
                                </div>
                            </div>

                            <div class="pagination" id="farmerTransactionsPagination">
                                <!-- Pagination controls will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Investor Portal View -->
            <div id="investorView" class="view">
                <div class="investor-dashboard">
                    <div class="dashboard-sidebar">
                        <div class="sidebar-menu">
                            <button class="menu-item active" data-section="browse">Browse Groves</button>
                            <button class="menu-item" data-section="portfolio">My Portfolio</button>
                            <button class="menu-item" data-section="marketplace">Marketplace</button>
                            <button class="menu-item" data-section="earnings">Earnings</button>
                            <button class="menu-item" data-section="lending">Lending</button>
                            <button class="menu-item" data-section="transactions">Transaction History</button>
                            <button class="menu-item" data-section="verification">Verification</button>
                        </div>
                    </div>
                    
                    <div class="dashboard-content">
                        <!-- Browse Groves Section -->
                        <div id="browseSection" class="section active">
                            <div class="section-header">
                                <h3>Available Coffee Groves</h3>
                                <div class="filters">
                                    <select id="varietyFilter">
                                        <option value="">All Varieties</option>
                                        <option value="Arabica">Arabica</option>
                                        <option value="Robusta">Robusta</option>
                                        <option value="Bourbon">Bourbon</option>
                                        <option value="Typica">Typica</option>
                                        <option value="Caturra">Caturra</option>
                                        <option value="Geisha">Geisha</option>
                                    </select>
                                    <select id="locationFilter">
                                        <option value="">All Locations</option>
                                    </select>
                                    <div class="yield-filter-container">
                                        <label for="yieldFilter">Min Yield: <span id="yieldFilterValue">0</span> kg/tree</label>
                                        <input type="range" id="yieldFilter" min="0" max="10" step="0.1" value="0">
                                    </div>
                                </div>
                            </div>
                            
                            <div class="groves-marketplace" id="grovesMarketplace">
                                <!-- Available groves will be populated here -->
                            </div>
                        </div>

                        <!-- Portfolio Section -->
                        <div id="portfolioSection" class="section">
                            <div class="section-header">
                                <h3>My Investment Portfolio</h3>
                            </div>
                            
                            <div class="portfolio-overview">
                                <div class="portfolio-stats">
                                    <div class="stat-card">
                                        <h4>Total Investment</h4>
                                        <div class="stat-value" id="totalInvestment">$0.00</div>
                                    </div>
                                    <div class="stat-card">
                                        <h4>Current Value</h4>
                                        <div class="stat-value" id="currentValue">$0.00</div>
                                    </div>
                                    <div class="stat-card">
                                        <h4>Total Returns</h4>
                                        <div class="stat-value" id="totalReturns">$0.00</div>
                                    </div>
                                    <div class="stat-card">
                                        <h4>ROI</h4>
                                        <div class="stat-value" id="roi">0%</div>
                                    </div>
                                </div>
                                
                                <div class="portfolio-chart">
                                    <canvas id="portfolioChart"></canvas>
                                </div>
                            </div>
                            
                            <div class="holdings-list" id="holdingsList">
                                <!-- Token holdings will be populated here -->
                            </div>
                        </div>

                        <!-- Marketplace Section -->
                        <div id="marketplaceSection" class="section">
                            <div class="section-header">
                                <h3>Secondary Market</h3>
                                <div class="section-actions">
                                    <button class="btn btn-secondary" id="viewTradeHistoryBtn">
                                        View Trade History
                                    </button>
                                </div>
                            </div>
                            
                            <div class="marketplace-content">
                                <div class="market-listings" id="marketListings">
                                    <!-- Market listings will be populated here -->
                                </div>
                                
                                <div class="trade-history" id="tradeHistory" style="display: none;">
                                    <!-- Trade history will be populated here -->
                                </div>
                            </div>
                        </div>

                        <!-- Earnings Section -->
                        <div id="earningsSection" class="section">
                            <div class="section-header">
                                <h3>My Earnings</h3>
                            </div>
                            
                            <!-- Earnings Stats Cards -->
                            <div class="earnings-stats">
                                <div class="stat-card">
                                    <h4>Total Earnings</h4>
                                    <div class="stat-value" id="totalEarningsValue">$0.00</div>
                                    <small class="stat-label">All-time earnings from distributions</small>
                                </div>
                                <div class="stat-card">
                                    <h4>Pending Distributions</h4>
                                    <div class="stat-value" id="pendingEarningsValue">$0.00</div>
                                    <small class="stat-label">Available to claim</small>
                                </div>
                                <div class="stat-card">
                                    <h4>This Month</h4>
                                    <div class="stat-value" id="monthlyEarningsValue">$0.00</div>
                                    <small class="stat-label">Earnings this month</small>
                                </div>
                                <div class="stat-card">
                                    <h4>Claimed Earnings</h4>
                                    <div class="stat-value" id="claimedEarningsValue">$0.00</div>
                                    <small class="stat-label">Successfully claimed</small>
                                </div>
                            </div>
                            
                            <!-- Pending Distributions Section -->
                            <div class="earnings-section-container">
                                <div class="section-header">
                                    <h4>Pending Distributions</h4>
                                    <small>Claim your earnings from recent harvests</small>
                                </div>
                                <div id="pendingDistributionsList" class="distributions-list">
                                    <!-- Pending distributions will be populated here -->
                                </div>
                            </div>
                            
                            <!-- Earnings Chart -->
                            <div class="earnings-section-container">
                                <div class="section-header">
                                    <h4>Earnings Timeline</h4>
                                    <small>Monthly earnings trend</small>
                                </div>
                                <div class="earnings-chart-container">
                                    <canvas id="earningsChart"></canvas>
                                </div>
                            </div>
                            
                            <!-- Earnings History -->
                            <div class="earnings-section-container">
                                <div class="section-header">
                                    <h4>Earnings History</h4>
                                    <small>Complete history of all distributions</small>
                                </div>
                                <div class="earnings-list" id="earningsList">
                                    <!-- Earnings history will be populated here -->
                                </div>
                            </div>
                        </div>

                        <!-- Lending Section -->
                        <div id="lendingSection" class="section">
                            <div class="section-header">
                                <h3>Lending & Liquidity</h3>
                                <small>Provide liquidity to earn returns or take loans against your holdings</small>
                            </div>
                            
                            <!-- Lending Pools Overview -->
                            <div class="lending-pools-container">
                                <div class="section-header">
                                    <h4>Available Lending Pools</h4>
                                    <small>Provide USDC liquidity to earn APY</small>
                                </div>
                                
                                <div class="lending-pools-grid" id="lendingPoolsGrid">
                                    <!-- Lending pools will be populated here -->
                                </div>
                            </div>
                            
                            <!-- User's Liquidity Positions -->
                            <div class="liquidity-positions-container">
                                <div class="section-header">
                                    <h4>Your Liquidity Positions</h4>
                                    <small>Your active liquidity provisions and LP tokens</small>
                                </div>
                                
                                <div class="liquidity-positions-list" id="liquidityPositionsList">
                                    <!-- User's liquidity positions will be populated here -->
                                </div>
                            </div>
                            
                            <!-- Provide Liquidity Modal -->
                            <div id="provideLiquidityModal" class="modal">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h4>Provide Liquidity</h4>
                                        <button class="modal-close">&times;</button>
                                    </div>
                                    <div class="modal-body">
                                        <div class="pool-details-summary" id="poolDetailsSummary">
                                            <!-- Pool details will be populated here -->
                                        </div>
                                        
                                        <form id="provideLiquidityForm">
                                            <div class="form-group">
                                                <label for="liquidityAmount">Amount (USDC)</label>
                                                <input 
                                                    type="number" 
                                                    id="liquidityAmount" 
                                                    name="amount" 
                                                    step="0.01" 
                                                    min="0.01" 
                                                    placeholder="Enter USDC amount"
                                                    required
                                                >
                                                <small class="form-help" id="liquidityAmountHelp">Available: $0.00</small>
                                            </div>
                                            
                                            <div class="liquidity-calculation">
                                                <div class="calc-row">
                                                    <span>LP Tokens to Receive:</span>
                                                    <span id="lpTokensToReceive">0.00</span>
                                                </div>
                                                <div class="calc-row">
                                                    <span>Your Pool Share:</span>
                                                    <span id="yourPoolShare">0.00%</span>
                                                </div>
                                                <div class="calc-row">
                                                    <span>Estimated Annual Return:</span>
                                                    <span id="estimatedAnnualReturn">$0.00</span>
                                                </div>
                                            </div>
                                            
                                            <div class="modal-actions">
                                                <button type="button" class="btn btn-secondary modal-close">Cancel</button>
                                                <button type="submit" class="btn btn-primary">Provide Liquidity</button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Withdraw Liquidity Modal -->
                            <div id="withdrawLiquidityModal" class="modal">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h4>Withdraw Liquidity</h4>
                                        <button class="modal-close">&times;</button>
                                    </div>
                                    <div class="modal-body">
                                        <div class="withdrawal-details-summary" id="withdrawalDetailsSummary">
                                            <!-- Withdrawal details will be populated here -->
                                        </div>
                                        
                                        <form id="withdrawLiquidityForm">
                                            <div class="form-group">
                                                <label for="lpTokenAmount">LP Tokens to Withdraw</label>
                                                <div class="input-with-button">
                                                    <input 
                                                        type="number" 
                                                        id="lpTokenAmount" 
                                                        name="lpTokenAmount" 
                                                        step="0.01" 
                                                        min="0.01" 
                                                        placeholder="Enter LP token amount"
                                                        required
                                                    >
                                                    <button 
                                                        type="button" 
                                                        class="btn btn-secondary btn-small" 
                                                        id="withdrawMaxBtn"
                                                    >
                                                        Max
                                                    </button>
                                                </div>
                                                <small class="form-help" id="lpTokenAmountHelp">Available: 0.00 LP tokens</small>
                                            </div>
                                            
                                            <div class="withdrawal-calculation">
                                                <div class="calc-row">
                                                    <span>USDC to Receive:</span>
                                                    <span id="usdcToReceive">$0.00</span>
                                                </div>
                                                <div class="calc-row">
                                                    <span>Accrued Rewards:</span>
                                                    <span id="accruedRewards">$0.00</span>
                                                </div>
                                                <div class="calc-row">
                                                    <span>Total Amount:</span>
                                                    <span id="totalWithdrawalAmount" class="text-success">$0.00</span>
                                                </div>
                                            </div>
                                            
                                            <div class="modal-actions">
                                                <button type="button" class="btn btn-secondary modal-close">Cancel</button>
                                                <button type="submit" class="btn btn-primary">Withdraw Liquidity</button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>

                            <!-- Loans Section -->
                            <div class="loans-container">
                                  <div class="section-header">
                                      <h4>Loans</h4>
                                      <small>Borrow against your coffee tree token holdings</small>
                                  </div>

                                  <!-- Loan Availability Card -->
                                  <div class="loan-availability-card">
                                      <div class="card-header">
                                          <h5>Available Loan Amount</h5>
                                      </div>
                                      <div class="card-body">
                                          <div class="loan-stats">
                                              <div class="stat-item">
                                                  <label>Your Holdings Value</label>
                                                  <span class="stat-value" id="holdingsValue">$0.00</span>
                                              </div>
                                              <div class="stat-item">
                                                  <label>Max Loan Amount</label>
                                                  <span class="stat-value text-primary" id="maxLoanAmount">$0.00</span>
                                                  <small class="stat-help">Based on 125% collateralization</small>
                                              </div>
                                              <div class="stat-item">
                                                  <label>Collateralization Ratio</label>
                                                  <span class="stat-value" id="collateralizationRatio">125%</span>
                                              </div>
                                          </div>
                                          
                                          <div class="loan-terms-info">
                                              <h6>Loan Terms</h6>
                                              <ul class="terms-list">
                                                  <li><strong>Collateral Required:</strong> 125% of loan value</li>
                                                  <li><strong>Liquidation Threshold:</strong> 90% of collateral value</li>
                                                  <li><strong>Repayment Amount:</strong> 110% of loan amount</li>
                                                  <li><strong>Interest Rate:</strong> 10% of loan amount</li>
                                              </ul>
                                          </div>
                                          
                                          <button class="btn btn-primary" id="takeLoanBtn" disabled>
                                              Take Out Loan
                                          </button>
                                      </div>
                                  </div>

                                  <!-- Active Loan Display -->
                                  <div class="active-loan-container" id="activeLoanContainer" style="display: none;">
                                      <div class="section-header">
                                          <h5>Your Active Loan</h5>
                                      </div>
                                      <div class="active-loan-card" id="activeLoanCard">
                                          <!-- Active loan details will be populated here -->
                                      </div>
                                  </div>

                              <!-- Take Loan Modal -->
                              <div id="takeLoanModal" class="modal">
                                  <div class="modal-content">
                                      <div class="modal-header">
                                          <h4>Take Out Loan</h4>
                                          <button class="modal-close">&times;</button>
                                      </div>
                                      <div class="modal-body">
                                          <div class="loan-terms-summary">
                                              <h5>Loan Terms</h5>
                                              <div class="terms-grid">
                                                  <div class="term-item">
                                                      <label>Your Holdings Value</label>
                                                      <span id="modalHoldingsValue">$0.00</span>
                                                  </div>
                                                  <div class="term-item">
                                                      <label>Max Loan Amount</label>
                                                      <span id="modalMaxLoanAmount">$0.00</span>
                                                  </div>
                                              </div>
                                          </div>

                              <!-- Repay Loan Modal -->
                              <div id="repayLoanModal" class="modal">
                                  <div class="modal-content">
                                      <div class="modal-header">
                                          <h4>Repay Loan</h4>
                                          <button class="modal-close">&times;</button>
                                      </div>
                                      <div class="modal-body">
                                          <div class="repayment-summary">
                                              <h5>Loan Repayment Details</h5>
                                              <div class="summary-grid">
                                                  <div class="summary-item">
                                                      <label>Original Loan Amount</label>
                                                      <span id="modalLoanAmount">$0.00</span>
                                                  </div>
                                                  <div class="summary-item">
                                                      <label>Interest (10%)</label>
                                                      <span id="modalInterest">$0.00</span>
                                                  </div>
                                                  <div class="summary-item">
                                                      <label>Total Repayment</label>
                                                      <span id="modalTotalRepayment" class="text-primary">$0.00</span>
                                                  </div>
                                                  <div class="summary-item">
                                                      <label>Collateral to Unlock</label>
                                                      <span id="modalCollateralUnlock">0 tokens</span>
                                                  </div>
                                              </div>
                                          </div>
                                          
                                          <div class="repayment-info">
                                              <p><strong> Repaying this loan will:</strong></p>
                                              <ul>
                                                  <li>Transfer the repayment amount from your wallet</li>
                                                  <li>Unlock your collateral tokens</li>
                                                  <li>Close your active loan</li>
                                                  <li>Restore your ability to take new loans</li>
                                              </ul>
                                          </div>
                                          
                                          <div class="modal-actions">
                                              <button type="button" class="btn btn-secondary modal-close">Cancel</button>
                                              <button type="button" class="btn btn-primary" id="confirmRepayBtn">
                                                  Confirm Repayment
                                              </button>
                                          </div>
                                      </div>
                                  </div>
                              </div>
                                          
                                          <form id="takeLoanForm">
                                              <div class="form-group">
                                                  <label for="loanAmount">Loan Amount (USDC)</label>
                                                  <div class="input-with-button">
                                                      <input 
                                                          type="number" 
                                                          id="loanAmount" 
                                                          name="loanAmount" 
                                                          step="0.01" 
                                                          min="0.01" 
                                                          placeholder="Enter loan amount"
                                                          required
                                                      >
                                                      <button 
                                                          type="button" 
                                                          class="btn btn-secondary btn-small" 
                                                          id="loanMaxBtn"
                                                      >
                                                          Max
                                                      </button>
                                                  </div>
                                                  <small class="form-help" id="loanAmountHelp">Max available: $0.00</small>
                                              </div>
                                              
                                              <div class="loan-calculation">
                                                  <h6>Loan Details</h6>
                                                  <div class="calc-row">
                                                      <span>Collateral Required:</span>
                                                      <span id="collateralRequired">0 tokens</span>
                                                  </div>
                                                  <div class="calc-row">
                                                      <span>Liquidation Price:</span>
                                                      <span id="liquidationPrice" class="text-warning">$0.00</span>
                                                  </div>
                                                  <div class="calc-row">
                                                      <span>Repayment Amount:</span>
                                                      <span id="repaymentAmount" class="text-primary">$0.00</span>
                                                  </div>
                                                  <div class="calc-row">
                                                      <span>Interest (10%):</span>
                                                      <span id="interestAmount">$0.00</span>
                                                  </div>
                                              </div>
                                              
                                              <div class="loan-warning">
                                                  <p><strong> Important:</strong> Your tokens will be locked as collateral. If the value drops below the liquidation threshold, your collateral may be liquidated.</p>
                                              </div>
                                              
                                              <div class="modal-actions">
                                                  <button type="button" class="btn btn-secondary modal-close">Cancel</button>
                                                  <button type="submit" class="btn btn-primary">Confirm Loan</button>
                                              </div>
                                          </form>
                                      </div>
                                  </div>
                              </div>
                              </div>
                            </div>
                        </div>

                        <!-- Transaction History Section -->
                        <div id="transactionsSection" class="section">
                            <div class="section-header">
                                <h3>Transaction History</h3>
                                <div class="section-actions">
                                    <select id="transactionTypeFilter" class="filter-select">
                                        <option value="all">All Transactions</option>
                                        <option value="purchase">Token Purchases</option>
                                        <option value="sale">Token Sales</option>
                                        <option value="distribution">Revenue Distributions</option>
                                        <option value="loan">Loans</option>
                                        <option value="loan_repayment">Loan Repayments</option>
                                        <option value="withdrawal">Withdrawals</option>
                                        <option value="liquidity_provided">Liquidity Provided</option>
                                        <option value="liquidity_withdrawn">Liquidity Withdrawn</option>
                                    </select>
                                    <button id="exportTransactionsBtn" class="btn btn-secondary">
                                        📥 Export to CSV
                                    </button>
                                </div>
                            </div>

                            <div class="transaction-stats">
                                <div class="stat-card">
                                    <h4>Total Transactions</h4>
                                    <div class="stat-value" id="totalTransactions">0</div>
                                </div>
                                <div class="stat-card">
                                    <h4>Total Volume</h4>
                                    <div class="stat-value" id="totalVolume">$0.00</div>
                                </div>
                                <div class="stat-card">
                                    <h4>Completed</h4>
                                    <div class="stat-value" id="completedTransactions">0</div>
                                </div>
                                <div class="stat-card">
                                    <h4>Pending</h4>
                                    <div class="stat-value" id="pendingTransactions">0</div>
                                </div>
                            </div>

                            <div class="transactions-list" id="transactionsList">
                                <!-- Transactions will be populated here -->
                                <div class="empty-state">
                                    <p>No transactions found</p>
                                </div>
                            </div>

                            <div class="pagination" id="transactionsPagination">
                                <!-- Pagination controls will be populated here -->
                            </div>
                        </div>

                        <!-- Investor Verification Section -->
                        <div id="verificationSection" class="section">
                            <div class="section-header">
                                <h3>Investor Verification</h3>
                            </div>
                            
                            <div class="verification-status" id="investorVerificationStatus">
                                <!-- Verification status will be populated here -->
                            </div>
                            
                            <div class="verification-form" id="investorVerificationForm">
                                <h4>Submit Verification Documents</h4>
                                <div class="form-instructions">
                                    <p>Please upload clear, legible copies of the following documents. All documents must be current and valid.</p>
                                </div>
                                <form id="investorDocumentsForm">
                                    <div class="form-group">
                                        <label for="investorIdentityDocument">🆔 Government-Issued Identity Document</label>
                                        <small class="form-help">National ID, passport, driver's license, or state-issued ID card</small>
                                        <input type="file" id="investorIdentityDocument" name="identityDocument" accept=".pdf,.jpg,.png" required>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="proofOfAddress">🏠 Proof of Address</label>
                                        <small class="form-help">Utility bill, bank statement, lease agreement, or government correspondence (last 3 months)</small>
                                        <input type="file" id="proofOfAddress" name="proofOfAddress" accept=".pdf,.jpg,.png" required>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="financialInformation">💼 Financial Information</label>
                                        <small class="form-help">Bank statement, income verification, investment account statement, or tax return</small>
                                        <input type="file" id="financialInformation" name="financialInformation" accept=".pdf,.jpg,.png" required>
                                    </div>
                                    
                                    <div class="form-requirements">
                                        <h6>Document Requirements:</h6>
                                        <ul>
                                            <li>✅ Accepted formats: PDF, JPG, PNG</li>
                                            <li>✅ Maximum file size: 10MB per document</li>
                                            <li>✅ Documents must be clear and legible</li>
                                            <li>✅ All text must be readable</li>
                                            <li>✅ Documents must be current and valid</li>
                                            <li>✅ Address documents must be from last 3 months</li>
                                        </ul>
                                    </div>
                                    
                                    <button type="submit" class="btn btn-primary">Submit Documents for Review</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Admin Panel View -->
            <div id="adminView" class="view">
                <div class="admin-dashboard">
                    <div class="dashboard-sidebar">
                        <div class="sidebar-menu">
                            <button class="menu-item active" data-section="token-operations">Token Operations</button>
                            <button class="menu-item" data-section="kyc-management">KYC Management</button>
                            <button class="menu-item" data-section="token-holders">Token Holders</button>
                        </div>
                    </div>
                    
                    <div class="dashboard-content">
                        <!-- Token Operations Section -->
                        <div id="tokenOperationsSection" class="section active">
                            <div class="section-header">
                                <h3>Token Operations</h3>
                                <small>Manage token supply for coffee groves</small>
                            </div>
                            
                            <!-- Grove Selection -->
                            <div class="admin-grove-selector">
                                <div class="form-group">
                                    <label for="adminGroveSelect">Select Grove</label>
                                    <select id="adminGroveSelect" class="grove-select">
                                        <option value="">Select a grove...</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- Token Supply Display -->
                            <div id="tokenSupplyDisplay" class="token-supply-card" style="display: none;">
                                <h4>Token Supply Information</h4>
                                <div class="supply-stats">
                                    <div class="stat-card">
                                        <h5>Total Supply</h5>
                                        <div class="stat-value" id="totalSupply">-</div>
                                        <small class="stat-label">Total tokens minted</small>
                                    </div>
                                    <div class="stat-card">
                                        <h5>Circulating Supply</h5>
                                        <div class="stat-value" id="circulatingSupply">-</div>
                                        <small class="stat-label">Tokens in circulation</small>
                                    </div>
                                    <div class="stat-card">
                                        <h5>Holder Count</h5>
                                        <div class="stat-value" id="holderCount">-</div>
                                        <small class="stat-label">Number of token holders</small>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Token Operations Forms -->
                            <div id="tokenOperationsForms" class="token-operations-container" style="display: none;">
                                <div class="operations-grid">
                                    <!-- Mint Tokens Form -->
                                    <div class="operation-card">
                                        <h4>Mint Tokens</h4>
                                        <p>Increase token supply for the selected grove</p>
                                        <form id="mintTokensForm" class="token-operation-form">
                                            <div class="form-group">
                                                <label for="mintAmount">Amount to Mint</label>
                                                <input 
                                                    type="number" 
                                                    id="mintAmount" 
                                                    name="amount" 
                                                    min="1" 
                                                    step="1" 
                                                    placeholder="Enter token amount"
                                                    required
                                                >
                                                <small class="form-help">Number of tokens to create</small>
                                            </div>
                                            <button type="submit" class="btn btn-primary">
                                                Mint Tokens
                                            </button>
                                        </form>
                                    </div>
                                    
                                    <!-- Burn Tokens Form -->
                                    <div class="operation-card">
                                        <h4>Burn Tokens</h4>
                                        <p>Decrease token supply for the selected grove</p>
                                        <form id="burnTokensForm" class="token-operation-form">
                                            <div class="form-group">
                                                <label for="burnAmount">Amount to Burn</label>
                                                <input 
                                                    type="number" 
                                                    id="burnAmount" 
                                                    name="amount" 
                                                    min="1" 
                                                    step="1" 
                                                    placeholder="Enter token amount"
                                                    required
                                                >
                                                <small class="form-help">Number of tokens to destroy</small>
                                            </div>
                                            <button type="submit" class="btn btn-danger">
                                                Burn Tokens
                                            </button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Token Operation History -->
                            <div id="tokenOperationHistory" class="operation-history-container" style="display: none;">
                                <div class="section-header">
                                    <h4>Operation History</h4>
                                    <small>Recent token operations for this grove</small>
                                </div>
                                <div class="operation-history-list" id="operationHistoryList">
                                    <!-- Operation history will be populated here -->
                                </div>
                            </div>
                        </div>

                        <!-- KYC Management Section -->
                        <div id="kycManagementSection" class="section">
                            <div class="section-header">
                                <h3>KYC Management</h3>
                                <small>Manage KYC approval for token holders</small>
                            </div>
                            
                            <!-- Grove Selection for KYC -->
                            <div class="admin-grove-selector">
                                <div class="form-group">
                                    <label for="kycGroveSelect">Select Grove</label>
                                    <select id="kycGroveSelect" class="grove-select">
                                        <option value="">Select a grove...</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- KYC Management Interface -->
                            <div id="kycManagementInterface" class="kyc-management-container" style="display: none;">
                                <!-- Add Account for KYC -->
                                <div class="kyc-add-account">
                                    <h4>Grant KYC Approval</h4>
                                    <form id="grantKYCForm" class="kyc-form">
                                        <div class="form-group">
                                            <label for="kycAccountAddress">Account Address</label>
                                            <input 
                                                type="text" 
                                                id="kycAccountAddress" 
                                                name="accountAddress" 
                                                placeholder="0.0.xxxxx"
                                                required
                                            >
                                            <small class="form-help">Hedera account ID to grant KYC approval</small>
                                        </div>
                                        <button type="submit" class="btn btn-primary">
                                            Grant KYC
                                        </button>
                                    </form>
                                </div>
                                
                                <!-- KYC Status List -->
                                <div class="kyc-accounts-list">
                                    <div class="section-header">
                                        <h4>Account KYC Status</h4>
                                        <small>List of accounts and their KYC approval status</small>
                                    </div>
                                    <div id="kycAccountsList">
                                        <!-- KYC accounts will be populated here -->
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Token Holders Section -->
                        <div id="tokenHoldersSection" class="section">
                            <div class="section-header">
                                <h3>Token Holders</h3>
                                <small>View all token holders for a grove</small>
                            </div>
                            
                            <!-- Grove Selection for Holders -->
                            <div class="admin-grove-selector">
                                <div class="form-group">
                                    <label for="holdersGroveSelect">Select Grove</label>
                                    <select id="holdersGroveSelect" class="grove-select">
                                        <option value="">Select a grove...</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- Token Holders Display -->
                            <div id="tokenHoldersDisplay" class="token-holders-container" style="display: none;">
                                <!-- Export Button -->
                                <div class="holders-actions">
                                    <button id="exportHoldersBtn" class="btn btn-secondary">
                                        Export to CSV
                                    </button>
                                </div>
                                
                                <!-- Holders List -->
                                <div class="holders-list-container">
                                    <table class="holders-table">
                                        <thead>
                                            <tr>
                                                <th>Account Address</th>
                                                <th>Token Balance</th>
                                                <th>Share %</th>
                                                <th>KYC Status</th>
                                            </tr>
                                        </thead>
                                        <tbody id="holdersTableBody">
                                            <!-- Holders will be populated here -->
                                        </tbody>
                                    </table>
                                </div>
                                
                                <!-- Pagination -->
                                <div class="pagination-container" id="holdersPagination">
                                    <!-- Pagination controls will be added here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Loading Overlay -->
        <div id="loadingOverlay" class="loading-overlay hidden">
            <div class="loading-spinner"></div>
            <div class="loading-text">Loading...</div>
        </div>

        <!-- Toast Notifications -->
        <div id="toastContainer" class="toast-container"></div>
    </div>

    <script src="js/errors.js"></script>
    <script src="js/error-handler.js"></script>
    <script src="js/notification-manager.js"></script>
    <script src="js/api.js"></script>
    <script src="js/wallet.js"></script>
    <script src="js/balance-poller.js"></script>
    <script src="js/marketplace.js"></script>
    <script src="js/price-oracle.js"></script>
    <script src="js/market-prices-display.js"></script>
    <script src="js/token-admin.js"></script>
    <script src="js/admin-panel.js"></script>
    <script src="js/farmer-dashboard.js"></script>
    <script src="js/investor-portal.js"></script>
    <script src="js/main.js"></script>
    <script src="demo-helper.js"></script>
    <script>
        // Check if we should navigate to a specific view
        document.addEventListener('DOMContentLoaded', function() {
            // Check if we should navigate to a specific view
            const targetView = localStorage.getItem('targetView');
            if (targetView) {
                localStorage.removeItem('targetView');
                // Delay to ensure everything is initialized
                setTimeout(() => {
                    if (window.viewManager) {
                        window.viewManager.switchView(targetView);
                    }
                }, 100);
            }
        });
    </script>
</body>
</html>
